#include "GEMM/gemm_int4.h"

// clang-format off
// macros to be filled in CMake 
#define WG_M ${WG_M}
#define WG_N ${WG_N}
#define SG_M ${SG_M}
#define SG_N ${SG_N}
#define SG_K ${SG_K}
#define SLM_KS ${SLM_KS}
#define L3_KS ${L3_KS}
#define SYNC_FREQ ${SYNC_FREQ}
#define STAGES ${STAGES}
#define ARCH static_cast<int>(gpu_arch::${ARCH})
#define QUANT_MODE quant_mode::${QUANT_MODE}
// clang-format on

namespace torch_ipex::xpu::xetla {
using fp16 = gpu::xetla::fp16;
using bf16 = gpu::xetla::bf16;

#define HGEMM_WINT4_INTERFACE_IMPL_GZ(gz) \
  HGEMM_WINT4_INTERFACE_IMPL(             \
      WG_M,                               \
      WG_N,                               \
      SG_M,                               \
      SG_N,                               \
      SG_K,                               \
      gz,                                 \
      SLM_KS,                             \
      L3_KS,                              \
      SYNC_FREQ,                          \
      STAGES,                             \
      ARCH,                               \
      QUANT_MODE)

// per channel
HGEMM_WINT4_INTERFACE_IMPL_GZ(0)
// k group
HGEMM_WINT4_INTERFACE_IMPL_GZ(16)
HGEMM_WINT4_INTERFACE_IMPL_GZ(32)
HGEMM_WINT4_INTERFACE_IMPL_GZ(64)
HGEMM_WINT4_INTERFACE_IMPL_GZ(128)
HGEMM_WINT4_INTERFACE_IMPL_GZ(256)
HGEMM_WINT4_INTERFACE_IMPL_GZ(512)
HGEMM_WINT4_INTERFACE_IMPL_GZ(1024)

} // namespace torch_ipex::xpu::xetla
